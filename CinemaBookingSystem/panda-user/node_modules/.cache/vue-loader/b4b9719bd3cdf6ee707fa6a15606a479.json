{"remainingRequest":"D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\src\\views\\user\\BillInfo.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\src\\views\\user\\BillInfo.vue","mtime":1715002116196},{"path":"D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1715002107957},{"path":"D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\node_modules\\babel-loader\\lib\\index.js","mtime":1715002107113},{"path":"D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1715002107957},{"path":"D:\\javaProjects\\pqq\\CinemaBookingSystem\\panda-user\\node_modules\\vue-loader\\lib\\index.js","mtime":1715002115483}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCcNCmltcG9ydCBiaWxsRGV0YWlsIGZyb20gJy4uL3BheS9CaWxsRGV0YWlsJw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiQmlsbEluZm8iLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBxdWVyeUluZm86IHsNCiAgICAgICAgdXNlcklkOiAnJw0KICAgICAgfSwNCiAgICAgIGJpbGxMaXN0OiBbDQogICAgICAgIHsNCiAgICAgICAgICBzeXNTZXNzaW9uOiB7DQogICAgICAgICAgICBzeXNNb3ZpZTogew0KICAgICAgICAgICAgICBtb3ZpZVBvc3RlcjogJycNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzeXNDaW5lbWE6IHt9LA0KICAgICAgICAgICAgc3lzSGFsbDoge30NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIF0NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5nZXRVc2VyKCkNCiAgICB0aGlzLmdldEJpbGxMaXN0KCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldFVzZXIoKSB7DQogICAgICB0aGlzLnF1ZXJ5SW5mby51c2VySWQgPSBKU09OLnBhcnNlKHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdsb2dpblVzZXInKSkudXNlcklkDQogICAgfSwNCiAgICBhc3luYyBnZXRCaWxsTGlzdCgpIHsNCiAgICAgIGNvbnN0IF90aGlzID0gdGhpcw0KICAgICAgYXdhaXQgYXhpb3MuZ2V0KCdzeXNCaWxsJyx7cGFyYW1zOl90aGlzLnF1ZXJ5SW5mb30pLnRoZW4ocmVzcD0+ew0KICAgICAgICBfdGhpcy5iaWxsTGlzdCA9IHJlc3AuZGF0YS5kYXRhDQogICAgICB9KQ0KDQogICAgICBmb3IobGV0IGlkeCBpbiB0aGlzLmJpbGxMaXN0KSB7DQogICAgICAgIHRoaXMuYmlsbExpc3RbaWR4XS5zeXNTZXNzaW9uLnNlc3Npb25EYXRlID0gbW9tZW50KHRoaXMuYmlsbExpc3RbaWR4XS5zeXNTZXNzaW9uLnNlc3Npb25EYXRlKS5mb3JtYXQoJ1lZWVnlubRNTeaciERE5pelJykNCiAgICAgICAgdGhpcy5iaWxsTGlzdFtpZHhdLnN5c1Nlc3Npb24uc3lzTW92aWUubW92aWVQb3N0ZXIgPQ0KICAgICAgICAgIHRoaXMuZ2xvYmFsLmJhc2UgKyBKU09OLnBhcnNlKHRoaXMuYmlsbExpc3RbaWR4XS5zeXNTZXNzaW9uLnN5c01vdmllLm1vdmllUG9zdGVyKVswXQ0KICAgICAgfQ0KDQogICAgfSwNCiAgICB0b0JpbGxEZXRhaWwoaWQpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvYmlsbERldGFpbC8nICsgaWQpDQogICAgfSwNCiAgICBhc3luYyBkZWxldGVCaWxsKGlkKSB7DQogICAgICBjb25zdCBfdGhpcyA9IHRoaXMNCiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCB0aGlzLiRjb25maXJtKCfmraTmk43kvZzlsIbmsLjkuYXliKDpmaTpooTnuqbkv6Hmga8s5piv5ZCm57un57utPycsJ+aPkOekuicsew0KICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsDQogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLA0KICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgIH0pLmNhdGNoKGVycj0+ZXJyKQ0KICAgICAgaWYgKHJlc3A9PT0iY2FuY2VsIikgew0KICAgICAgICByZXR1cm4gX3RoaXMuJG1lc3NhZ2UuaW5mbygn5bey5Y+W5raI5Yig6ZmkJykNCiAgICAgIH0NCiAgICAgIGF3YWl0IGF4aW9zLmRlbGV0ZSgnc3lzQmlsbC8nK2lkKS50aGVuKHJlc3A9PnsNCiAgICAgICAgaWYgKHJlc3AuZGF0YS5jb2RlICE9PSAyMDApew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOWksei0pe+8gScpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgICBhd2FpdCB0aGlzLmdldEJpbGxMaXN0KCkNCiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5Yqf77yBJykNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["BillInfo.vue"],"names":[],"mappings":";AA0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BillInfo.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div class=\"bill-list-container\">\r\n    <div class=\"profile-title\">我的预约</div>\r\n    <div class=\"order-box\" v-for=\"item in billList\">\r\n      <div class=\"order-header\">\r\n        <span class=\"order-date\">预约时间：{{item.createTime}}</span>\r\n        <span class=\"order-id\">预约编号: {{item.billId}}</span>\r\n        <span class=\"del-order\"  @click=\"deleteBill(item.billId)\">\r\n          <i class=\"el-icon-delete\"></i>\r\n        </span>\r\n      </div>\r\n      <div class=\"order-body\">\r\n        <div class=\"poster\">\r\n          <img :src=\"item.sysSession.sysMovie.moviePoster\">\r\n        </div>\r\n        <div class=\"order-content\">\r\n          <div class=\"movie-name\">《{{item.sysSession.sysMovie.movieName}}》</div>\r\n          <div class=\"cinema-name\">{{item.sysSession.sysHall.sysCinema.cinemaName}}</div>\r\n          <div class=\"hall-ticket\">\r\n            <span>放映厅：{{item.sysSession.sysHall.hallName}}({{item.sysSession.sysHall.hallCategory}})</span>\r\n            <span></span>\r\n          </div>\r\n          <div class=\"show-time\">播放时间：{{item.sysSession.sessionDate + ' ' + item.sysSession.playTime + ' - ' + item.sysSession.endTime}}</div>\r\n        </div>\r\n        <div class=\"order-price\">\r\n          ￥{{item.sysSession.sessionPrice * JSON.parse(item.seats).length}} (\r\n          {{JSON.parse(item.seats).length}}*{{item.sysSession.sessionPrice}}/张 )\r\n        </div>\r\n        <div class=\"order-status\">\r\n          {{item.payState?'已完成':'未完成'}}\r\n        </div>\r\n        <div class=\"actions\">\r\n          <div>\r\n            <a @click=\"toBillDetail(item.billId)\" class=\"order-detail\" >查看详情</a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment'\r\nimport billDetail from '../pay/BillDetail'\r\nexport default {\r\n  name: \"BillInfo\",\r\n  data() {\r\n    return {\r\n      queryInfo: {\r\n        userId: ''\r\n      },\r\n      billList: [\r\n        {\r\n          sysSession: {\r\n            sysMovie: {\r\n              moviePoster: ''\r\n            },\r\n            sysCinema: {},\r\n            sysHall: {}\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  created() {\r\n    this.getUser()\r\n    this.getBillList()\r\n  },\r\n  methods: {\r\n    getUser() {\r\n      this.queryInfo.userId = JSON.parse(window.sessionStorage.getItem('loginUser')).userId\r\n    },\r\n    async getBillList() {\r\n      const _this = this\r\n      await axios.get('sysBill',{params:_this.queryInfo}).then(resp=>{\r\n        _this.billList = resp.data.data\r\n      })\r\n\r\n      for(let idx in this.billList) {\r\n        this.billList[idx].sysSession.sessionDate = moment(this.billList[idx].sysSession.sessionDate).format('YYYY年MM月DD日')\r\n        this.billList[idx].sysSession.sysMovie.moviePoster =\r\n          this.global.base + JSON.parse(this.billList[idx].sysSession.sysMovie.moviePoster)[0]\r\n      }\r\n\r\n    },\r\n    toBillDetail(id) {\r\n      this.$router.push('/billDetail/' + id)\r\n    },\r\n    async deleteBill(id) {\r\n      const _this = this\r\n      const resp = await this.$confirm('此操作将永久删除预约信息,是否继续?','提示',{\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).catch(err=>err)\r\n      if (resp===\"cancel\") {\r\n        return _this.$message.info('已取消删除')\r\n      }\r\n      await axios.delete('sysBill/'+id).then(resp=>{\r\n        if (resp.data.code !== 200){\r\n          this.$message.error('删除失败！')\r\n        }\r\n      })\r\n      await this.getBillList()\r\n      this.$message.success('删除成功！')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.bill-list-container{\r\n  min-height: 900px;\r\n}\r\n\r\n.profile-title {\r\n  padding: 26px 0;\r\n  color: #ec443f;\r\n  font-size: 18px;\r\n  border-bottom: 1px solid #e1e1e1;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.order-box {\r\n  border: 1px solid #e5e5e5;\r\n  margin: 0 40px 30px 0;\r\n}\r\n\r\n.order-box .order-header {\r\n  background-color: #f7f7f7;\r\n  font-size: 14px;\r\n  padding: 16px 20px;\r\n}\r\n\r\n.order-box .order-header .order-date {\r\n  color: #333;\r\n  display: inline-block;\r\n  margin-right: 30px;\r\n}\r\n\r\n.order-box .order-header .order-id {\r\n  color: #999;\r\n}\r\n\r\n.del-order{\r\n  float: right;\r\n}\r\n\r\n.order-box .order-body {\r\n  padding: 20px;\r\n  padding-right: 0;\r\n  display: flex;\r\n}\r\n\r\n.order-box .order-body .poster {\r\n  width: 66px;\r\n  height: 91px;\r\n  margin-right: 11px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)\r\n}\r\n\r\n.poster img{\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.order-content{\r\n  width: 49%;\r\n}\r\n\r\n.movie-name{\r\n  font-size: 16px;\r\n  font-weight: 700;\r\n  color: #333;\r\n  margin: 4px 0 7px -6px;\r\n}\r\n\r\n.cinema-name, .hall-ticket {\r\n  font-size: 12px;\r\n  color: #999;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.show-time {\r\n  font-size: 12px;\r\n  color: #f03d37;\r\n}\r\n\r\n.order-price, .order-status, .actions{\r\n  font-size: 14px;\r\n  color: #333;\r\n  width: 15%;\r\n  line-height: 95px;\r\n}\r\n.order-detail {\r\n  color: #2d98f3;\r\n}\r\na {\r\n  text-decoration: none;\r\n  cursor: pointer;\r\n  color: #333;\r\n}\r\n</style>\r\n"]}]}
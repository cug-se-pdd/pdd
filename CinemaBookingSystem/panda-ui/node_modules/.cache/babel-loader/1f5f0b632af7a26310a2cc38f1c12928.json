{"remainingRequest":"F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\babel-loader\\lib\\index.js!F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Code\\CinemaBookingSystem\\panda-ui\\src\\views\\cinema\\CinemaInfo.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\Code\\CinemaBookingSystem\\panda-ui\\src\\views\\cinema\\CinemaInfo.vue","mtime":1714207564411},{"path":"F:\\Code\\CinemaBookingSystem\\panda-ui\\babel.config.js","mtime":1714207564376},{"path":"F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1714209991146},{"path":"F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1714209992890},{"path":"F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1714209991146},{"path":"F:\\Code\\CinemaBookingSystem\\panda-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1714209993504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBnbG9iYWwgZnJvbSAiLi4vLi4vYXNzZXRzL2Nzcy9nbG9iYWwuY3NzIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvL+aOp+WItuWvueivneahhueahOaYvuekuuS4jumakOiXjwogICAgICBlZGl0RGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGVkaXRGb3JtOiB7fSwKICAgICAgY2luZW1hSW5mbzoge30sCiAgICAgIGVkaXRGb3JtUnVsZXM6IHsKICAgICAgICBjaW5lbWFOYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5b2x6Zmi5ZCN56ewJywKICAgICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgICAgfV0sCiAgICAgICAgY2luZW1hQWRkcmVzczogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeW9semZouWcsOWdgCcsCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICAgIH1dLAogICAgICAgIGNpbmVtYVBob25lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5b2x6Zmi55S16K+dJywKICAgICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgICAgfV0KICAgICAgfSwKICAgICAgaW5wdXRIYWxsOiAnJywKICAgICAgZGlhbG9nSW1hZ2VVcmw6ICcnLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgaGlkZVVwbG9hZDogZmFsc2UsCiAgICAgIC8v5re75Yqg5Yig6Zmk5Zu+54mHIOWKqOaAgee7keWumuWbvueJh+WIl+ihqAogICAgICBwaWNzOiBbXSwKICAgICAgLy/mt7vliqDliKDpmaTlvbHljoXnsbvliKsg5Yqo5oCB57uR5a6a5b2x5Y6F5YiX6KGoCiAgICAgIGhhbGxzOiBbXSwKICAgICAgLy8g5Y+R6YCB57uZ5ZCO56uv55qESlNPTuWbvueJh+aVsOe7hAogICAgICBwaWN0dXJlTGlzdDogW10sCiAgICAgIHBpY051bXM6IDAsCiAgICAgIGRlbGV0ZVBpY0xpc3Q6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Q2luZW1hSW5mbygpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0Q2luZW1hSW5mbygpIHsKICAgICAgY29uc3QgX3RoaXMgPSB0aGlzOwogICAgICBhd2FpdCBheGlvcy5nZXQoJ3N5c0NpbmVtYScpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgX3RoaXMuY2luZW1hSW5mbyA9IHJlc3AuZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgX3RoaXMucGljcyA9IFtdOwogICAgICBfdGhpcy5oYWxscyA9IFtdOwogICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgSlNPTi5wYXJzZSh0aGlzLmNpbmVtYUluZm8uY2luZW1hUGljdHVyZSkpIHsKICAgICAgICBsZXQgcGljID0ge307CiAgICAgICAgcGljWyduYW1lJ10gPSAnJzsKICAgICAgICBwaWNbJ3VybCddID0gdGhpcy5nbG9iYWwuYmFzZSArIGl0ZW07CiAgICAgICAgdGhpcy5waWNzLnB1c2gocGljKTsKICAgICAgfQogICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgSlNPTi5wYXJzZSh0aGlzLmNpbmVtYUluZm8uaGFsbENhdGVnb3J5TGlzdCkpIHsKICAgICAgICB0aGlzLmhhbGxzLnB1c2goaXRlbSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDmmL7npLrkv67mlLnlr7nor53moYbvvIzlm57mmL7mlbDmja4KICAgIGFzeW5jIHNob3dFZGl0RGlhbG9nKCkgewogICAgICB0aGlzLmVkaXRGb3JtID0gdGhpcy5jaW5lbWFJbmZvOwogICAgICB0aGlzLmVkaXREaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICAvLyDnm5HlkKzkv67mlLnlr7nor53moYbnmoTlhbPpl63kuovku7YKICAgIGVkaXREaWFsb2dDbG9zZWQoKSB7CiAgICAgIHRoaXMuJHJlZnMuZWRpdEZvcm1SZWYucmVzZXRGaWVsZHMoKTsKICAgICAgdGhpcy4kcmVmcy5waWN0dXJlRWRpdFJlZi5jbGVhckZpbGVzKCk7CiAgICAgIHRoaXMucGljcyA9IFtdOwogICAgICB0aGlzLnBpY3R1cmVMaXN0ID0gW107CiAgICAgIHRoaXMuaGFsbHMgPSBbXTsKICAgICAgdGhpcy5nZXRDaW5lbWFJbmZvKCk7CiAgICB9LAogICAgLy8g5Y+W5raI5L+u5pS5CiAgICBjYW5jZWxFZGl0KCkgewogICAgICB0aGlzLmVkaXREaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuZGVsZXRlUGljTGlzdC5zcGxpY2UoMCwgdGhpcy5kZWxldGVQaWNMaXN0Lmxlbmd0aCk7CiAgICB9LAogICAgYXN5bmMgZWRpdENpbmVtYUluZm8oKSB7CiAgICAgIGF3YWl0IHRoaXMuc3VibWl0RmlsZSgpOwogICAgICB0aGlzLmVkaXRGb3JtLmNpbmVtYVBpY3R1cmUgPSBKU09OLnN0cmluZ2lmeSh0aGlzLnBpY3R1cmVMaXN0KTsKICAgICAgdGhpcy5lZGl0Rm9ybS5oYWxsQ2F0ZWdvcnlMaXN0ID0gSlNPTi5zdHJpbmdpZnkodGhpcy5oYWxscyk7CiAgICAgIHRoaXMuJHJlZnMuZWRpdEZvcm1SZWYudmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gewogICAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47CiAgICAgICAgbGV0IHN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMucHV0WydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJzsKICAgICAgICBhd2FpdCBheGlvcy5wdXQoJ3N5c0NpbmVtYS91cGRhdGUnLCBKU09OLnN0cmluZ2lmeShfdGhpcy5lZGl0Rm9ybSkpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICBpZiAocmVzcC5kYXRhLmNvZGUgIT09IDIwMCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkv67mlLnlvbHpmaLkv6Hmga/lpLHotKXvvIEnKTsKICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlmICghc3VjY2VzcykgcmV0dXJuOwogICAgICAgIHRoaXMuZWRpdERpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICBhd2FpdCB0aGlzLmdldENpbmVtYUluZm8oKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/ruaUueW9semZouS/oeaBr+aIkOWKn++8gScpOwogICAgICAgIGZvciAobGV0IGl0ZW0gb2YgdGhpcy5kZWxldGVQaWNMaXN0KSB7CiAgICAgICAgICBhd2FpdCBheGlvcy5nZXQoJy91cGxvYWQvZGVsZXRlP2ZpbGVQYXRoPScgKyBpdGVtLnN1YnN0cmluZyhpdGVtLmluZGV4T2YoJy9pbWFnZXMnKSkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgYWRkSGFsbENhdGVnb3J5KCkgewogICAgICBpZiAodGhpcy5pbnB1dEhhbGwgPT09ICcnIHx8IHRoaXMuaW5wdXRIYWxsID09PSBudWxsKSB7CiAgICAgICAgdGhpcy4kYWxlcnQoJ+W9seWOheexu+WIq+a3u+WKoOWksei0pe+8geWOn+WboO+8muaJgOa3u+WKoOeahOW9seWOheexu+WIq+S4jeiDveS4uuepuuOAgicsICflvbHljoXnsbvliKvmt7vliqDlvILluLgnLCB7CiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+aIkeefpemBk+S6hicKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuaGFsbHMuaW5jbHVkZXModGhpcy5pbnB1dEhhbGwpKSB7CiAgICAgICAgdGhpcy5oYWxscy5wdXNoKHRoaXMuaW5wdXRIYWxsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygn5bey5a2Y5ZyoJyk7CiAgICAgICAgdGhpcy4kYWxlcnQoJ+W9seWOheexu+WIq+a3u+WKoOWksei0pe+8geWOn+WboO+8muaJgOa3u+WKoOeahOW9seWOheexu+WIq+W3suWtmOWcqOOAgicsICflvbHljoXnsbvliKvmt7vliqDlvILluLgnLCB7CiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+aIkeefpemBk+S6hicKICAgICAgICB9KTsKICAgICAgfQogICAgICB0aGlzLmlucHV0SGFsbCA9ICcnOwogICAgfSwKICAgIGRlbGV0ZUhhbGxDYXRlZ29yeShpbmRleCkgewogICAgICB0aGlzLmhhbGxzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuaGFsbHMpOwogICAgfSwKICAgIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgewogICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUudXJsOwogICAgICBjb25zb2xlLmxvZyhmaWxlUGF0aCk7CiAgICAgIGNvbnN0IGlkeCA9IHRoaXMucGljcy5maW5kSW5kZXgoeCA9PiB4LnVybCA9PT0gZmlsZVBhdGgpOwogICAgICBpZiAoZmlsZS5zdGF0dXMgPT09ICdzdWNjZXNzJykgewogICAgICAgIHRoaXMuZGVsZXRlUGljTGlzdC5wdXNoKGZpbGUudXJsKTsKICAgICAgfQogICAgICB0aGlzLnBpY3Muc3BsaWNlKGlkeCwgMSk7CiAgICB9LAogICAgaGFuZGxlUGljdHVyZUNhcmRQcmV2aWV3KGZpbGUpIHsKICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZUNoYW5nZShmaWxlLCBmaWxlbGlzdCkgewogICAgICB0aGlzLnBpY3MgPSBmaWxlbGlzdC5zbGljZSgwKTsKICAgIH0sCiAgICBoYW5kbGVTdWNjZXNzKHJlc3BvbnNlKSB7CiAgICAgIHRoaXMucGljdHVyZUxpc3QucHVzaChyZXNwb25zZS5kYXRhKTsKICAgICAgdGhpcy5lZGl0Rm9ybSA9IEpTT04uc3RyaW5naWZ5KHRoaXMucGljdHVyZUxpc3QpOwogICAgfSwKICAgIGhhbmRsZUVycm9yKGVycikgewogICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgfSwKICAgIGFzeW5jIHN1Ym1pdEZpbGUoKSB7CiAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnBpY3MubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICBpZiAodGhpcy5waWNzW2ldLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICBsZXQgcyA9IHRoaXMucGljc1tpXS51cmw7CiAgICAgICAgICB0aGlzLnBpY3R1cmVMaXN0LnB1c2gocy5zdWJzdHJpbmcocy5pbmRleE9mKCcvaW1hZ2VzJykpKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBsZXQgZmlsZSA9IHRoaXMucGljc1tpXS5yYXc7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7CiAgICAgICAgYXdhaXQgYXhpb3MucG9zdCgndXBsb2FkL2NpbmVtYScsIGZvcm1EYXRhKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIF90aGlzLnBpY3R1cmVMaXN0LnB1c2gocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"names":["global","data","editDialogVisible","editForm","cinemaInfo","editFormRules","cinemaName","required","message","trigger","cinemaAddress","cinemaPhone","inputHall","dialogImageUrl","dialogVisible","hideUpload","pics","halls","pictureList","picNums","deletePicList","created","getCinemaInfo","methods","_this","axios","get","then","resp","item","JSON","parse","cinemaPicture","pic","base","push","hallCategoryList","showEditDialog","editDialogClosed","$refs","editFormRef","resetFields","pictureEditRef","clearFiles","cancelEdit","splice","length","editCinemaInfo","submitFile","stringify","validate","valid","success","defaults","headers","put","code","$message","error","substring","indexOf","addHallCategory","$alert","confirmButtonText","includes","console","log","deleteHallCategory","index","handleRemove","file","fileList","filePath","url","idx","findIndex","x","status","handlePictureCardPreview","handleChange","filelist","slice","handleSuccess","response","handleError","err","i","formData","FormData","s","raw","append","post"],"sources":["src/views/cinema/CinemaInfo.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!--面包屑导航区域-->\r\n    <div class=\"board\">\r\n      <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n        <el-breadcrumb-item :to=\"{ path: '/welcome' }\">首页</el-breadcrumb-item>\r\n        <el-breadcrumb-item>影院管理</el-breadcrumb-item>\r\n        <el-breadcrumb-item>影院信息管理</el-breadcrumb-item>\r\n      </el-breadcrumb>\r\n    </div>\r\n\r\n    <!--卡片视图-->\r\n    <el-card class=\"box-card\">\r\n      <!--表格显示影院信息-->\r\n      <el-form :model=\"cinemaInfo\" label-width=\"150px\">\r\n        <el-form-item label=\"影院名称: \" prop=\"cinemaName\">\r\n          <el-input class=\"el-input-show\" v-model=\"cinemaInfo.cinemaName\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"影院地址: \" prop=\"cinemaAddress\">\r\n          <el-input class=\"el-input-show\" v-model=\"cinemaInfo.cinemaAddress\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"影院电话: \" prop=\"cinemaPhone\">\r\n          <el-input class=\"el-input-show\" v-model=\"cinemaInfo.cinemaPhone\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"营业时间: \" prop=\"cinemaPhone\">\r\n          <el-input class=\"el-input-show-time\" v-model=\"cinemaInfo.workStartTime\" disabled></el-input>\r\n          至\r\n          <el-input class=\"el-input-show-time\" v-model=\"cinemaInfo.workEndTime\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"拥有影厅类型: \" prop=\"hallCategory\">\r\n          <el-tag v-for=\"hall in halls\" >{{hall}}</el-tag>\r\n        </el-form-item>\r\n        <el-form-item label=\"影院图片: \">\r\n          <span v-for=\"item in pics\">\r\n            <el-popover placement=\"left\" trigger=\"click\" width=\"300\">\r\n              <img :src=\"item.url\" width=\"200%\"/>\r\n              <img slot=\"reference\" :src=\"item.url\" :alt=\"item\"\r\n                   style=\"max-height: 300px;max-width: 300px;padding: 10px\"/>\r\n            </el-popover>\r\n          </span>\r\n        </el-form-item>\r\n        <el-form-item label=\"\" prop=\"cinemaName\">\r\n          <el-button type=\"primary\" @click=\"showEditDialog\">修改影院信息</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n\r\n    <!--修改影院对话框-->\r\n    <el-dialog title=\"修改影院\" :visible.sync=\"editDialogVisible\" width=\"60%\" @close=\"editDialogClosed\">\r\n      <el-form :model=\"editForm\" :rules=\"editFormRules\" ref=\"editFormRef\" label-width=\"150px\">\r\n        <el-form-item label=\"影院名称\" prop=\"cinemaName\">\r\n          <el-input v-model=\"editForm.cinemaName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"影院地址\" prop=\"cinemaAddress\">\r\n          <el-input v-model=\"editForm.cinemaAddress\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"影院电话\" prop=\"cinemaPhone\">\r\n          <el-input v-model=\"editForm.cinemaPhone\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"开始营业时间\" prop=\"workStartTime\">\r\n          <el-time-picker\r\n            v-model=\"editForm.workStartTime\"\r\n            value-format=\"HH:mm\"\r\n            placeholder=\"选择开始营业时间\">\r\n          </el-time-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"结束营业时间\" prop=\"workEndTime\">\r\n          <el-time-picker\r\n            v-model=\"editForm.workEndTime\"\r\n            value-format=\"HH:mm\"\r\n            placeholder=\"选择结束营业时间\">\r\n          </el-time-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"拥有影厅类型\" prop=\"hallCategoryList\">\r\n          <el-input class=\"el-input-hall\" placeholder=\"请输入添加影厅类别名称\" v-model=\"inputHall\" clearable></el-input>\r\n          <el-button type=\"primary\" @click=\"addHallCategory()\">添加</el-button>\r\n        </el-form-item>\r\n        <el-form-item >\r\n          <el-tag\r\n            v-for=\"(item, index) in halls\"\r\n            :key=\"index\"\r\n            closable\r\n            @close=\"deleteHallCategory(index)\">\r\n            {{item}}\r\n          </el-tag>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"影院图片\">\r\n          <el-upload action=\"\" list-type=\"picture-card\"\r\n                     :auto-upload=\"false\"\r\n                     :file-list=\"pics\"\r\n                     :on-change=\"handleChange\"\r\n                     :on-success=\"handleSuccess\"\r\n                     :on-error=\"handleError\"\r\n                     ref=\"pictureEditRef\"\r\n                     :http-request=\"submitFile\">\r\n            <i slot=\"default\" class=\"el-icon-plus\"></i>\r\n            <div slot=\"file\" slot-scope=\"{file}\">\r\n              <img class=\"el-upload-list__item-thumbnail\"\r\n                   :src=\"file.url\" alt=\"\">\r\n              <span class=\"el-upload-list__item-actions\">\r\n                <span class=\"el-upload-list__item-preview\"\r\n                      @click=\"handlePictureCardPreview(file)\">\r\n                  <i class=\"el-icon-zoom-in\"></i>\r\n                </span>\r\n                <span class=\"el-upload-list__item-delete\"\r\n                      @click=\"handleRemove(file)\">\r\n                  <i class=\"el-icon-delete\"></i>\r\n                </span>\r\n              </span>\r\n            </div>\r\n          </el-upload>\r\n          <!--放大预览-->\r\n          <el-dialog :visible.sync=\"dialogVisible\" append-to-body>\r\n            <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n          </el-dialog>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancelEdit\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"editCinemaInfo\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import global from \"../../assets/css/global.css\"\r\n  export default {\r\n    data() {\r\n      return {\r\n        //控制对话框的显示与隐藏\r\n        editDialogVisible: false,\r\n        editForm: {},\r\n        cinemaInfo: {},\r\n        editFormRules: {\r\n          cinemaName: [\r\n            { required: true, message: '请输入影院名称', trigger: 'change' }\r\n          ],\r\n          cinemaAddress: [\r\n            { required: true, message: '请输入影院地址', trigger: 'change' }\r\n          ],\r\n          cinemaPhone: [\r\n            { required: true, message: '请输入影院电话', trigger: 'change' }\r\n          ]\r\n        },\r\n        inputHall: '',\r\n\r\n        dialogImageUrl: '',\r\n        dialogVisible: false,\r\n        hideUpload: false,\r\n        //添加删除图片 动态绑定图片列表\r\n        pics: [],\r\n        //添加删除影厅类别 动态绑定影厅列表\r\n        halls: [],\r\n        // 发送给后端的JSON图片数组\r\n        pictureList: [],\r\n        picNums: 0,\r\n        deletePicList: []\r\n      }\r\n    },\r\n    created() {\r\n      this.getCinemaInfo()\r\n    },\r\n    methods: {\r\n      async getCinemaInfo() {\r\n        const _this = this\r\n        await axios.get('sysCinema').then(resp => {\r\n          _this.cinemaInfo = resp.data.data\r\n        })\r\n        _this.pics = []\r\n        _this.halls = []\r\n\r\n        for (const item of JSON.parse(this.cinemaInfo.cinemaPicture)) {\r\n          let pic = {}\r\n          pic['name'] = ''\r\n          pic['url'] = this.global.base + item\r\n          this.pics.push(pic)\r\n        }\r\n        for (const item of JSON.parse(this.cinemaInfo.hallCategoryList)) {\r\n          this.halls.push(item)\r\n        }\r\n      },\r\n      // 显示修改对话框，回显数据\r\n      async showEditDialog() {\r\n        this.editForm = this.cinemaInfo\r\n        this.editDialogVisible = true\r\n      },\r\n      // 监听修改对话框的关闭事件\r\n      editDialogClosed() {\r\n        this.$refs.editFormRef.resetFields()\r\n        this.$refs.pictureEditRef.clearFiles()\r\n        this.pics = []\r\n        this.pictureList = []\r\n        this.halls = []\r\n        this.getCinemaInfo()\r\n      },\r\n      // 取消修改\r\n      cancelEdit() {\r\n        this.editDialogVisible = false\r\n        this.deletePicList.splice(0, this.deletePicList.length)\r\n      },\r\n      async editCinemaInfo() {\r\n        await this.submitFile()\r\n        this.editForm.cinemaPicture = JSON.stringify(this.pictureList)\r\n        this.editForm.hallCategoryList = JSON.stringify(this.halls)\r\n        this.$refs.editFormRef.validate(async valid => {\r\n          const _this = this\r\n          if (!valid) return\r\n          let success = true\r\n          axios.defaults.headers.put['Content-Type'] = 'application/json'\r\n          await axios.put('sysCinema/update', JSON.stringify(_this.editForm)).then(resp => {\r\n            if (resp.data.code !== 200){\r\n              this.$message.error('修改影院信息失败！')\r\n              success = false\r\n            }\r\n          })\r\n          if (!success) return\r\n          this.editDialogVisible = false\r\n          await this.getCinemaInfo()\r\n          this.$message.success('修改影院信息成功！')\r\n          for(let item of this.deletePicList) {\r\n            await axios.get('/upload/delete?filePath=' + item.substring(item.indexOf('/images')))\r\n          }\r\n        })\r\n      },\r\n      addHallCategory() {\r\n        if (this.inputHall === '' || this.inputHall === null) {\r\n          this.$alert('影厅类别添加失败！原因：所添加的影厅类别不能为空。', '影厅类别添加异常', {\r\n            confirmButtonText: '我知道了'\r\n          })\r\n          return\r\n        } else if (!this.halls.includes(this.inputHall)) {\r\n          this.halls.push(this.inputHall)\r\n        } else {\r\n          console.log('已存在')\r\n          this.$alert('影厅类别添加失败！原因：所添加的影厅类别已存在。', '影厅类别添加异常', {\r\n            confirmButtonText: '我知道了'\r\n          })\r\n        }\r\n        this.inputHall = ''\r\n      },\r\n      deleteHallCategory(index) {\r\n        this.halls.splice(index, 1)\r\n        console.log(this.halls)\r\n      },\r\n      handleRemove(file, fileList) {\r\n        const filePath = file.url\r\n        console.log(filePath)\r\n        const idx = this.pics.findIndex(x => x.url === filePath)\r\n        if (file.status === 'success') {\r\n          this.deletePicList.push(file.url)\r\n        }\r\n        this.pics.splice(idx, 1)\r\n      },\r\n      handlePictureCardPreview(file) {\r\n        this.dialogImageUrl = file.url\r\n        this.dialogVisible = true\r\n      },\r\n      handleChange(file, filelist){\r\n        this.pics = filelist.slice(0)\r\n      },\r\n      handleSuccess(response){\r\n        this.pictureList.push(response.data)\r\n        this.editForm = JSON.stringify(this.pictureList)\r\n      },\r\n      handleError(err){\r\n        console.log(err)\r\n      },\r\n      async submitFile() {\r\n        const _this = this\r\n        for (let i = 0; i < this.pics.length; i++){\r\n          let formData = new FormData()\r\n          if (this.pics[i].status === 'success') {\r\n            let s = this.pics[i].url\r\n            this.pictureList.push(s.substring(s.indexOf('/images')))\r\n            continue\r\n          }\r\n          let file = this.pics[i].raw\r\n          formData.append('file', file)\r\n          await axios.post('upload/cinema', formData).then(response =>{\r\n            _this.pictureList.push(response.data.data)\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.el-tag{\r\n  margin: 0 10px 10px 0;\r\n}\r\n.row{\r\n  white-space: nowrap;\r\n  margin-top: 10px;\r\n  padding: 0 10px;\r\n  text-align: center;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.row2{\r\n  margin-top: 20px;\r\n}\r\n.el-input-show{\r\n  width: 420px;\r\n}\r\n.el-input-show-time{\r\n  width: 100px;\r\n}\r\n.el-input-hall {\r\n  width: 240px;\r\n  margin: 0 20px 0px 0;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}